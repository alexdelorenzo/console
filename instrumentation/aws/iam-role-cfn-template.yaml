#
# Serverless Inc.'s Observability AWS IAM Role CloudFormation Template
#
# This is an AWS CloudFormation Template featuring the IAM Role required for Serverless Inc.'s
# (serverless.com) monitoring & observability products. It features a lot of AWS services
# because Serverless Inc.'s observability products support many AWS services.
#
# This template aims to be secure and user-friendly for your security leaders. It features:
#
#  - Clear separation of READ and (a few) WRITE permissions.
#  - Explicit permissions for IAM Actions. No asterisks.
#  - Removal of all sensitive IAM READ Actions (e.g. Data Records, Secrets, Source Code)
#  - In-line descriptions of every Resource and Action.
#  - Links back to the AWS documentation of the Action.
#  - Additional comments from Serverless Inc.
#
# We're standing by to answer your questions. Please contact our sales team at: sales@serverless.com
#

AWSTemplateFormatVersion: "2010-09-09"
Description: This is the IAM Role required to integrate your AWS account with Serverless Inc.'s (serverless.com) monitoring and observability products.
Resources:
  ServerlessRole:
    Type: AWS::IAM::Role
    Properties:
      AssumeRolePolicyDocument:
        Version: "2012-10-17"
        Statement:
          - Effect: Allow
            Principal:
              AWS: arn:aws:iam::486128539022:root
            Action:
              - sts:AssumeRole
            Condition:
              StringEquals:
                sts:ExternalId:
                  Ref: ExternalId
      Path: "/"
      RoleName: ServerlessRole
      Policies:
        - PolicyName: "serverless-read-policy-1"
          PolicyDocument:
            Version: "2012-10-17"
            Statement:
              - Effect: Allow
                Action:
                  #
                  ##
                  ###
                  #### READ PERMISSIONS
                  ###
                  ##
                  #

                  #
                  ## API Gateway V1
                  # https://docs.aws.amazon.com/apigateway/latest/api/API_Operations.html

                  # Gets information about the current Account resource.
                  - "apigateway:GetAccount"
                  # Describe an existing Authorizer resource.
                  - "apigateway:GetAuthorizer*"
                  # Describe an existing Authorizers resource.
                  - "apigateway:GetBasePathMapping*"
                  # Gets information about the current ClientCertificate resource.
                  - "apigateway:GetClientCertificate*"
                  # Gets information about a Deployment resource.
                  - "apigateway:GetDeployment*"
                  # Gets a documentation part.
                  - "apigateway:GetDocumentation*"
                  # Represents a domain name that is contained in a simpler, more intuitive URL that can be called.
                  - "apigateway:GetDomainName*"
                  # Exports a deployed version of a RestApi in a specified format.
                  - "apigateway:GetExport"
                  # Gets a GatewayResponse of a specified response type on the given RestApi.
                  - "apigateway:GetGatewayResponse*"
                  # Get the integration settings.
                  - "apigateway:GetIntegration*"
                  # Describe an existing Method resource.
                  - "apigateway:GetMethod*"
                  # Describes an existing model defined for a RestApi resource.
                  - "apigateway:GetModel*"
                  # Gets a RequestValidator of a given RestApi.
                  - "apigateway:GetRequestValidator*"
                  # Lists information about a resource.
                  - "apigateway:GetResource*"
                  # Lists the RestApi resource in the collection.
                  - "apigateway:GetRestApi*"
                  # Gets information about a Stage resource.
                  - "apigateway:GetStage*"
                  # Gets the Tags collection for a given resource.
                  - "apigateway:GetTags"
                  # Gets the usage data of a usage plan in a specified time interval.
                  - "apigateway:GetUsage*"
                  # Gets a specified VPC link under the caller's account in a region.
                  - "apigateway:GetVpcLink*"

                  #
                  ## API Gateway V2
                  # https://docs.aws.amazon.com/apigatewayv2/latest/api-reference/operations.html
                  # Serverless Inc. Comments: API Gateway V1 & V2 have overlapping IAM Actions.  However, V2 (AKA HTTP API) has additional IAM Actions, and we cover those here.

                  # Gets an Api resource.
                  - "apigateway:GetApi*"
                  # Gets the IntegrationResponses for an Integration.
                  - "apigateway:GetIntegration*"
                  # Gets a Route.
                  - "apigateway:GetRoute*"

                  #
                  ## App Runner
                  # https://docs.aws.amazon.com/apprunner/latest/api/API_Operations.html

                  # Retrieve the description of an AWS App Runner automatic scaling configuration resource.
                  - "apprunner:DescribeAutoScalingConfiguration"
                  # Retrieve descriptions of custom domain names associated with an AWS App Runner service.
                  - "apprunner:DescribeCustomDomains"
                  # Retrieve the description of an AWS App Runner observability configuration resource.
                  - "apprunner:DescribeObservabilityConfiguration"
                  # Retrieve the description of an operation that occurred on an AWS App Runner service.
                  - "apprunner:DescribeOperation"
                  # Retrieve the description of an AWS App Runner service.
                  - "apprunner:DescribeService"
                  # Retrieve the description of an AWS App Runner VPC connector resource.
                  - "apprunner:DescribeVpcConnector"
                  # Retrieve a list of AWS App Runner automatic scaling configurations in your AWS account.
                  - "apprunner:ListAutoScalingConfigurations"
                  # Retrieve a list of AWS App Runner connections in your AWS account.
                  - "apprunner:ListConnections"
                  # Retrieve a list of AWS App Runner observability configurations in your AWS account.
                  - "apprunner:ListObservabilityConfigurations"
                  # Retrieve a list of operations that occurred on an AWS App Runner service resource.
                  - "apprunner:ListOperations"
                  # Retrieve a list of running AWS App Runner services.
                  - "apprunner:ListServices"
                  # List tags associated with an AWS App Runner resource.
                  - "apprunner:ListTagsForResource"
                  # Retrieve a list of AWS App Runner VPC connectors in your AWS account.
                  - "apprunner:ListVpcConnectors"

                  #
                  ## AppSync
                  # https://docs.aws.amazon.com/appsync/latest/APIReference/API_Operations.html

                  # Read custom domain name - GraphQL API association details in AppSync.
                  - "appsync:GetApiAssociation"
                  # Retrieve a data source.
                  - "appsync:GetDataSource"
                  # Read information about a custom domain name in AppSync.
                  - "appsync:GetDomainName"
                  # Retrieve a function.
                  - "appsync:GetFunction"
                  # Retretrieve a GraphQL API.
                  - "appsync:GetGraphqlApi"
                  # Retrieve the introspection schema for a GraphQL API.
                  - "appsync:GetIntrospectionSchema"
                  # Retrieves a Resolver object.
                  - "appsync:GetResolver"
                  # Retrieves the current status of a schema creation operation.
                  - "appsync:GetSchemaCreationStatus"
                  # Enumerate custom domain names in AppSync.
                  - "appsync:ListDataSources"
                  # List the data sources for a given API.
                  - "appsync:ListDomainNames"
                  # List multiple functions.
                  - "appsync:ListFunctions"
                  # Lists GraphQL APIs.
                  - "appsync:ListGraphqlApis"
                  # Lists the resolvers for a given API and type.
                  - "appsync:ListResolvers*"
                  # List the tags for a resource.
                  - "appsync:ListTagsForResource"

                  #
                  ## Autoscaling
                  # https://docs.aws.amazon.com/autoscaling/plans/APIReference/API_Operations.html

                  # Describes the scalable resources in the specified scaling plan.
                  - "autoscaling:DescribeScalingPlan*"

                  #
                  ## Backup
                  # https://docs.aws.amazon.com/aws-backup/latest/devguide/API_Operations.html

                  # List backup plans.
                  - "backup:ListBackupPlan*"
                  # List backup vaults.
                  - "backup:ListBackupVaults"
                  # list frameworks.
                  - "backup:ListFrameworks"
                  # List protected resources by AWS Backup.
                  - "backup:ListProtectedResources"
                  # List tags for a resource.
                  - "backup:ListTags"

                  #
                  ## Cloudfront
                  # https://docs.aws.amazon.com/cloudfront/latest/APIReference/API_Operations.html

                  # Get a CloudFront function summary.
                  - "cloudfront:DescribeFunction"
                  # Get the cache policy.
                  - "cloudfront:GetCachePolicy*"
                  # Get the information about a web distribution.
                  - "cloudfront:GetDistribution*"
                  # List the distributions associated with your AWS account.
                  - "cloudfront:ListDistributions*"
                  # List of CloudFront functions.
                  - "cloudfront:ListFunctions"
                  # list tags for a CloudFront resource.
                  - "cloudfront:ListTagsForResource"

                  #
                  ## CloudTrail
                  # https://docs.aws.amazon.com/awscloudtrail/latest/APIReference/API_Operations.html

                  # List settings for the trails associated with the current region.
                  - "cloudtrail:DescribeTrails"
                  # List of information about the specified trail.
                  - "cloudtrail:GetTrailStatus"
                  # List the tags for trails or event data stores in the current region.
                  - "cloudtrail:ListTags"
                  # List trails associated with the current region for your account.
                  - "cloudtrail:ListTrails"
                  # Look up API activity events captured by CloudTrail.
                  - "cloudtrail:LookupEvents"

                  #
                  ## Cloudwatch
                  # https://docs.aws.amazon.com/AmazonCloudWatch/latest/APIReference/API_Operations.html

                  # Retrieve the history for the specified alarm.
                  - "cloudwatch:DescribeAlarm*"
                  # List the anomaly detection models that you have created in your account.
                  - "cloudwatch:DescribeAnomalyDetectors"
                  # Get all insight rules.
                  - "cloudwatch:DescribeInsightRules"
                  # Display the details of the CloudWatch dashboard you specify.
                  - "cloudwatch:GetDashboard"
                  # Return the top-N report of unique contributors over a time range for a given insight rule.
                  - "cloudwatch:GetInsightRuleReport"
                  # Retrieve batch amounts of CloudWatch metric data and perform metric math on retrieved data.
                  - "cloudwatch:GetMetric*"
                  # List of all CloudWatch dashboards in your account.
                  - "cloudwatch:ListDashboards"
                  # List of all CloudWatch metric streams.
                  - "cloudwatch:ListMetric*"
                  # List tags for an Amazon CloudWatch resource.
                  - "cloudwatch:ListTagsForResource"

                  #
                  ## Cloudwatch Logs
                  # https://docs.aws.amazon.com/AmazonCloudWatchLogs/latest/APIReference/API_Operations.html

                  # Return all the log groups that are associated with the AWS account making the request.
                  - "logs:DescribeLog*"
                  # Return all the subscription filters associated with the specified log group.
                  - "logs:DescribeSubscriptionFilters"
                  # Retrieve log events, optionally filtered by a filter pattern from the specified log group.
                  - "logs:FilterLogEvents"
                  # List the tags for the specified log group.
                  - "logs:ListTagsLogGroup"
                  # Test the filter pattern of a metric filter against a sample of log event messages.
                  - "logs:TestMetricFilter"

                  #
                  ## CodeBuild
                  # https://docs.aws.amazon.com/codebuild/latest/APIReference/API_Operations.html

                  # Get information about one or more build batches.
                  - "codebuild:BatchGetBuild*"
                  # Get information about one or more build projects.
                  - "codebuild:BatchGetProjects"
                  # List of build batch IDs, with each build batch ID representing a single build batch.
                  - "codebuild:ListBuild*"
                  # List of build project names, with each build project name representing a single build project.
                  - "codebuild:ListProjects"
                  # List of project ARNs that have been shared with the requester. Each project ARN represents one project.
                  - "codebuild:ListSharedProjects"

                  #
                  ## CodeDeploy
                  # https://docs.aws.amazon.com/codedeploy/latest/APIReference/API_Operations.html

                  # Get information about one or more application revisions.
                  - "codedeploy:BatchGetApplication*"
                  # Get information about one or more deployment groups.
                  - "codedeploy:BatchGetDeployment*"
                  # Get information about a single application associated with the IAM user.
                  - "codedeploy:GetApplication*"
                  # Get information about a single deployment to a deployment group for an application associated with the IAM user.
                  - "codedeploy:GetDeployment*"
                  # Get information about all application revisions for an application associated with the IAM user.
                  - "codedeploy:ListApplication*"
                  # Get information about all deployment configurations associated with the IAM user.
                  - "codedeploy:ListDeployment*"
                  # List of tags for the resource identified by a specified ARN. Tags are used to organize and categorize your CodeDeploy resources.
                  - "codedeploy:ListTagsForResource"

                  #
                  ## Cost Explorer
                  # https://docs.aws.amazon.com/aws-cost-management/latest/APIReference/API_Operations_AWS_Cost_Explorer_Service.html

                  # Retrieve descriptions such as the name, ARN, rules, definition, and effective dates of a Cost Category.
                  - "ce:DescribeCostCategoryDefinition"
                  # Retrieve the cost and usage metrics for your account.
                  - "ce:GetCostAndUsage*"
                  # Query Cost Catagory names and values for a specified time period.
                  - "ce:GetCostCategories"
                  # Query tags for a specified time period.
                  - "ce:GetTags"
                  # List Cost Allocation Tags.
                  - "ce:ListCostAllocationTags"
                  # Retrieve names, ARN, and effective dates for all Cost Categories.
                  - "ce:ListCostCategoryDefinitions"
                  # List tags for a Cost Explorer resource.
                  - "ce:ListTagsForResource"

                  #
                  ## DynamoDB
                  # https://docs.aws.amazon.com/amazondynamodb/latest/APIReference/API_Operations_Amazon_DynamoDB.html

                  # Describe an existing backup of a table.
                  - "dynamodb:DescribeBackup"
                  # Check the status of the backup restore settings on the specified table.
                  - "dynamodb:DescribeContinuousBackups"
                  # Describe the contributor insights status and related details for a given table or global secondary index.
                  - "dynamodb:DescribeContributorInsights"
                  # Describe an existing Export of a table.
                  - "dynamodb:DescribeExport"
                  # Return information about the specified global table.
                  - "dynamodb:DescribeGlobalTable*"
                  # Describe the status of Kinesis streaming and related details for a given table.
                  - "dynamodb:DescribeKinesisStreamingDestination"
                  # Return the current provisioned-capacity limits for your AWS account in a region, both for the region as a whole and for any one DynamoDB table that you create there.
                  - "dynamodb:DescribeLimits"
                  # Describe one or more of the Reserved Capacity purchased.
                  - "dynamodb:DescribeReservedCapacity*"
                  # Return information about a stream, including the current status of the stream, its Amazon Resource Name (ARN), the composition of its shards, and its corresponding DynamoDB table.
                  - "dynamodb:DescribeStream"
                  # Return information about the table.
                  - "dynamodb:DescribeTable*"
                  # Description of the Time to Live (TTL) status on the specified table.
                  - "dynamodb:DescribeTimeToLive"
                  # List backups associated with the account and endpoint.
                  - "dynamodb:ListBackups"
                  # List the ContributorInsightsSummary for all tables and global secondary indexes associated with the current account and endpoint.
                  - "dynamodb:ListContributorInsights"
                  # List exports associated with the account and endpoint.
                  - "dynamodb:ListExports"
                  # List all global tables that have a replica in the specified region.
                  - "dynamodb:ListGlobalTables"
                  # Return an array of stream ARNs associated with the current account and endpoint.
                  - "dynamodb:ListStreams"
                  # Return an array of table names associated with the current account and endpoint.
                  - "dynamodb:ListTables"
                  # List all tags on an Amazon DynamoDB resource.
                  - "dynamodb:ListTagsOfResource"

                  #
                  ## ECS
                  # https://docs.aws.amazon.com/AmazonECS/latest/APIReference/API_Operations.html

                  # Describe one or more Amazon ECS capacity providers.
                  - "ecs:DescribeCapacityProviders"
                  # Describes one or more of your clusters.
                  - "ecs:DescribeClusters"
                  # Describes Amazon ECS container instances.
                  - "ecs:DescribeContainerInstances"
                  # Describe the specified services running in your cluster.
                  - "ecs:DescribeServices"
                  # Describe a task definition. You can specify a family and revision to find information about a specific task definition, or you can simply specify the family to find the latest ACTIVE revision in that family.
                  - "ecs:DescribeTask*"
                  # List the account settings for an Amazon ECS resource for a specified principal.
                  - "ecs:ListAccountSettings"
                  # Lists the attributes for Amazon ECS resources within a specified target type and cluster.
                  - "ecs:ListAttributes"
                  # Get a list of existing clusters.
                  - "ecs:ListClusters"
                  # List of container instances in a specified cluster.
                  - "ecs:ListContainerInstances"
                  # Get a list of services that are running in a specified cluster.
                  - "ecs:ListServices"
                  # List of tags for the specified resource.
                  - "ecs:ListTagsForResource"
                  # List of task definition families that are registered to your account (which may include task definition families that no longer have any ACTIVE task definitions).
                  - "ecs:ListTaskDefinition*"
                  # List of tasks for a specified cluster.
                  - "ecs:ListTasks"

                  #
                  ## ElastiCache
                  # https://docs.aws.amazon.com/AmazonElastiCache/latest/APIReference/API_Operations.html

                  # List information about provisioned cache clusters.
                  - "elasticache:DescribeCache*"
                  # Retrieve the default engine and system parameter information for the specified cache engine.
                  - "elasticache:DescribeEngineDefaultParameters"
                  # List events related to clusters, cache security groups, and cache parameter groups.
                  - "elasticache:DescribeEvents"
                  # List information about global replication groups.
                  - "elasticache:DescribeGlobalReplicationGroups"
                  # List information about provisioned replication groups.
                  - "elasticache:DescribeReplicationGroups"
                  # List information about purchased reserved cache nodes.
                  - "elasticache:DescribeReservedCacheNodes"
                  # List details of the update actions for a set of clusters or replication groups.
                  - "elasticache:DescribeUpdateActions"
                  # List information about Redis user groups.
                  - "elasticache:DescribeUser*"
                  # List available node type that can be used to scale a particular Redis cluster or replication group.
                  - "elasticache:ListAllowedNodeTypeModifications"
                  # List tags for an ElastiCache resource.
                  - "elasticache:ListTagsForResource"

                  #
                  ## ELB (Elastic Load Balancing) V1
                  # https://docs.aws.amazon.com/elasticloadbalancing/2012-06-01/APIReference/API_Operations.html

                  # Describes the state of the specified instances with respect to the specified load balancer.
                  - "elasticloadbalancing:DescribeInstanceHealth"
                  # Describes the attributes for the specified load balancer.
                  - "elasticloadbalancing:DescribeLoadBalancer*"
                  # Describes the tags associated with the specified load balancers.
                  - "elasticloadbalancing:DescribeTags"

                  #
                  ## ELB (Elastic Load Balancing) V2
                  # https://docs.aws.amazon.com/elasticloadbalancing/latest/APIReference/API_Operations.html

                  # Describes the Elastic Load Balancing resource limits for the AWS account.
                  - "elasticloadbalancing:DescribeAccountLimits"
                  # Describes the specified listeners or the listeners for the specified Application Load Balancer.
                  - "elasticloadbalancing:DescribeListeners"
                  # Describes the attributes for the specified load balancer.
                  - "elasticloadbalancing:DescribeLoadBalancer*"
                  # Describes the specified rules or the rules for the specified listener.
                  - "elasticloadbalancing:DescribeRules"
                  # Describes the tags associated with the specified resource.
                  - "elasticloadbalancing:DescribeTags"
                  # Describes the attributes for the specified target group.
                  - "elasticloadbalancing:DescribeTargetGroup*"
                  # Describes the health of the specified targets or all of your targets.
                  - "elasticloadbalancing:DescribeTargetHealth"

                  #
                  ## EMR (Elastic Map Reduce)
                  # https://docs.aws.amazon.com/emr/latest/APIReference/API_Operations.html

                  # Get details about a cluster, including status, hardware and software configuration, VPC settings, and so on.
                  - "elasticmapreduce:DescribeCluster"
                  # Get details about a cluster step.
                  - "elasticmapreduce:DescribeStep"
                  # View information about an EMR Studio.
                  - "elasticmapreduce:DescribeStudio"
                  # Get details about the bootstrap actions associated with a cluster.
                  - "elasticmapreduce:ListBootstrapActions"
                  # Get the status of accessible clusters.
                  - "elasticmapreduce:ListClusters"
                  # Get details of instance fleets in a cluster.
                  - "elasticmapreduce:ListInstance*"
                  # List steps associated with a cluster.
                  - "elasticmapreduce:ListSteps"
                  # List summary information about EMR Studio session mappings.
                  - "elasticmapreduce:ListStudio*"

                  #
                  ## ES (ElasticSearch)
                  # https://docs.aws.amazon.com/opensearch-service/latest/developerguide/configuration-api.html

                  # View a description of the domain configuration for the specified OpenSearch Service domain, including the domain ID, service endpoint, and ARN.
                  - "es:DescribeDomain*"
                  # View a description of the domain configuration for the specified OpenSearch Service domain, including the domain ID, service endpoint, and ARN. This permission is deprecated. Use DescribeDomain instead.
                  - "es:DescribeElasticsearch*"
                  # Describe all packages available to OpenSearch Service domains.
                  - "es:DescribePackages"
                  # Display the names of all OpenSearch Service domains that the current user owns.
                  - "es:ListDomainNames"
                  # List all OpenSearch Service domains that a package is associated with.
                  - "es:ListDomainsForPackage"
                  # List all instance types and available features for a given OpenSearch version. This permission is deprecated. Use ListInstanceTypeDetails instead.
                  - "es:ListElasticsearchInstance*"
                  # List all instance types and available features for a given OpenSearch or Elasticsearch version.
                  - "es:ListInstanceTypeDetails"
                  # List all packages associated with the OpenSearch Service domain.
                  - "es:ListPackagesForDomain"
                  # Display all resource tags for an OpenSearch Service domain.
                  - "es:ListTags"

                  #
                  ## Health
                  # https://docs.aws.amazon.com/health/latest/APIReference/API_Operations.html

                  # Retrieve a list of accounts that have been affected by the specified events in organization.
                  - "health:DescribeAffectedAccountsForOrganization"
                  # Retrieve a list of entities that have been affected by the specified events.
                  - "health:DescribeAffectedEntities*"
                  # Retrieve the number of entities that are affected by each of the specified events.
                  - "health:DescribeEntityAggregates"
                  # Retrieve the number of events of each event type (issue, scheduled change, and account notification).
                  - "health:DescribeEventAggregates"
                  # Retrieve detailed information about one or more specified events.
                  - "health:DescribeEventDetails*"
                  # Retrieve the event types that meet the specified filter criteria.
                  - "health:DescribeEventTypes"
                  # Retrieve information about events that meet the specified filter criteria.
                  - "health:DescribeEvents*"
                  # Retrieve the status of enabling or disabling the Organizational View feature.
                  - "health:DescribeHealthServiceStatusForOrganization"

                  #
                  ## Kinesis
                  # https://docs.aws.amazon.com/kinesis/latest/APIReference/API_Operations.html

                  # Describe the specified stream.
                  - "kinesis:DescribeStream*"
                  # List the shards in a stream and provides information about each shard.
                  - "kinesis:ListShards"
                  # List the stream consumers registered to receive data from a Kinesis stream using enhanced fan-out, and provides information about each consumer.
                  - "kinesis:ListStream*"
                  # List the tags for the specified Amazon Kinesis stream.
                  - "kinesis:ListTagsForStream"

                  #
                  ## Lambda
                  # https://docs.aws.amazon.com/lambda/latest/dg/API_Operations.html

                  # Retrieves details about your account's limits and usage in an AWS Region.
                  - "lambda:GetAccountSettings"
                  # Returns details about a Lambda function alias.
                  - "lambda:GetAlias"
                  # Returns details about an event source mapping. You can get the identifier of a mapping from the output of ListEventSourceMappings.
                  - "lambda:GetEventSourceMapping"
                  # View details about the version-specific settings of an AWS Lambda function or version.
                  - "lambda:GetFunctionConfiguration"
                  # Returns details about the reserved concurrency configuration for a function. To set a concurrency limit for a function, use PutFunctionConcurrency.
                  - "lambda:GetFunctionConcurrency"
                  # View the configuration for asynchronous invocation for a function, version, or alias.
                  - "lambda:GetFunctionEventInvokeConfig"
                  # Read function url configuration for a Lambda function.
                  - "lambda:GetFunctionUrlConfig"
                  # View details about a version of an AWS Lambda layer. Note this action also supports GetLayerVersionByArn API.
                  - "lambda:GetLayerVersion*"
                  # View the resource-based policy for an AWS Lambda function, version, or alias.
                  - "lambda:GetPolicy"
                  # View the provisioned concurrency configuration for an AWS Lambda function's alias or version.
                  - "lambda:GetProvisionedConcurrencyConfig"
                  # Returns a list of aliases for a Lambda function.
                  - "lambda:ListAliases"
                  # Retrieve a list of AWS Lambda event source mappings.
                  - "lambda:ListCodeSigningConfigs"
                  # Retrieve a list of AWS Lambda event source mappings.
                  - "lambda:ListEventSourceMappings"
                  # Retrieve a list of configurations for asynchronous invocation for a function.
                  - "lambda:ListFunction*"
                  # Retrieve a list of versions of an AWS Lambda layer.
                  - "lambda:ListLayer*"
                  # Retrieve a list of provisioned concurrency configurations for an AWS Lambda function.
                  - "lambda:ListProvisionedConcurrencyConfigs"
                  # Retrieve a list of tags for an AWS Lambda function.
                  - "lambda:ListTags"
                  # Retrieve a list of versions for an AWS Lambda function.
                  - "lambda:ListVersionsByFunction"

                  #
                  ## Organizations
                  # https://docs.aws.amazon.com/organizations/latest/APIReference/API_Operations.html

                  # Retrieve Organizations-related details about the specified account.
                  - "organizations:DescribeAccount"
                  # Retrieve the effective policy for an account.
                  - "organizations:DescribeEffectivePolicy"
                  # Retrieves details about the organization that the calling credentials belong to.
                  - "organizations:DescribeOrganization*"
                  # Retrieves details about a policy.
                  - "organizations:DescribePolicy"
                  # Retrieve the list of the AWS services for which you enabled integration with your organization.
                  - "organizations:ListAWSServiceAccessForOrganization"
                  # List all of the the accounts in the organization.
                  - "organizations:ListAccounts*"
                  # List all of the OUs or accounts that are contained in a parent OU or root.
                  - "organizations:ListChildren"
                  # List the AWS accounts that are designated as delegated administrators in this organization.
                  - "organizations:ListDelegatedAdministrators"
                  # List the AWS services for which the specified account is a delegated administrator in this organization.
                  - "organizations:ListDelegatedServicesForAccount"
                  # Lists all of the organizational units (OUs) in a parent organizational unit or root.
                  - "organizations:ListOrganizationalUnitsForParent"
                  # List the root or organizational units (OUs) that serve as the immediate parent of a child OU or account.
                  - "organizations:ListParents"
                  # List all of the policies in an organization.
                  - "organizations:ListPolicies*"
                  # List all tags for the specified resource.
                  - "organizations:ListTagsForResource"
                  # List all the roots, OUs, and accounts to which a policy is attached.
                  - "organizations:ListTargetsForPolicy"

                  #
                  ## Resource Group Tagging
                  # https://docs.aws.amazon.com/resourcegroupstagging/latest/APIReference/API_Operations.html

                  # Return tagged or previously tagged resources in the specified AWS Region for the calling account.
                  - "tag:GetResources"
                  # Returns tag keys currently in use in the specified AWS Region for the calling account.
                  - "tag:GetTagKeys"
                  # Return tag values for the specified key that are used in the specified AWS Region for the calling account.
                  - "tag:GetTagValues"

                  #
                  ## RDS (Relational Database Service)
                  # https://docs.aws.amazon.com/AmazonRDS/latest/APIReference/API_Operations.html

                  # Return a list of DBClusterParameterGroup descriptions.
                  - "rds:DescribeDBCluster*"
                  # Return a list of the available DB engines.
                  - "rds:DescribeDBEngineVersions"
                  # Return information about provisioned RDS instances.
                  - "rds:DescribeDBInstances"
                  # Return a list of DBParameterGroup descriptions.
                  - "rds:DescribeDBParameterGroups"
                  # Return the detailed parameter list for a particular DB parameter group.
                  - "rds:DescribeDBParameters"
                  # View proxies.
                  - "rds:DescribeDBProx*"
                  # Return a list of DBSecurityGroup descriptions.
                  - "rds:DescribeDBSecurityGroups"
                  # Return a list of DBSubnetGroup descriptions.
                  - "rds:DescribeDBSubnetGroups"
                  # Display a list of categories for all event source types, or, if specified, for a specified source type.
                  - "rds:DescribeEvent*"
                  # Return a list of the source AWS Regions where the current AWS Region can create a Read Replica or copy a DB snapshot from.
                  - "rds:DescribeSourceRegions"
                  # List all tags on an Amazon RDS resource.
                  - "rds:ListTagsForResource"

                  #
                  ## Route 53
                  # https://docs.aws.amazon.com/Route53/latest/APIReference/API_Operations_Amazon_Route_53.html

                  # Get a list of the CIDR blocks within a specified CIDR collection.
                  - "route53:ListCidr*"
                  # Get a list of geographic locations that Route 53 supports for geolocation.
                  - "route53:ListGeoLocations"
                  # Get a list of the health checks that are associated with the current AWS account.
                  - "route53:ListHealthChecks"
                  # Get a list of the public and private hosted zones that are associated with the current AWS account.
                  - "route53:ListHostedZones"
                  # Get a list of your hosted zones in lexicographic order. Hosted zones are sorted by name with the labels reversed, for example, com.example.www.
                  - "route53:ListHostedZones*"
                  # List the configurations for DNS query logging that are associated with the current AWS account or the configuration that is associated with a specified hosted zone.
                  - "route53:ListQueryLoggingConfigs"
                  # List the records in a specified hosted zone.
                  - "route53:ListResourceRecordSets"
                  # List the reusable delegation sets that are associated with the current AWS account.
                  - "route53:ListReusableDelegationSets"
                  # List tags for one health check or hosted zone.
                  - "route53:ListTagsForResource"

                  #
                  ## S3
                  # https://docs.aws.amazon.com/AmazonS3/latest/API/API_Operations_Amazon_Simple_Storage_Service.html

                  # Retrieve the configurations for a multi region access point.
                  - "s3:DescribeMultiRegionAccessPointOperation"
                  # Return configuration information about the specified access point.
                  - "s3:GetAccessPoint"
                  # Retrieve the configuration of the object lambda enabled access point.
                  - "s3:GetAccessPoint*"
                  # Retrieve the PublicAccessBlock configuration for an AWS account.
                  - "s3:GetAccountPublicAccessBlock"
                  # Use the acl subresource to return the access control list (ACL) of an Amazon S3 bucket.
                  - "s3:GetBucketAcl"
                  # Return the CORS configuration information set for an Amazon S3 bucket.
                  - "s3:GetBucketCORS"
                  # Return the Region that an Amazon S3 bucket resides in.
                  - "s3:GetBucketLocation"
                  # Return the logging status of an Amazon S3 bucket and the permissions users have to view or modify that status.
                  - "s3:GetBucketLogging"
                  # Get the notification configuration of an Amazon S3 bucket.
                  - "s3:GetBucketNotification"
                  # Retrieve ownership controls on a bucket.
                  - "s3:GetBucketOwnershipControls"
                  # Return the policy of the specified bucket.
                  - "s3:GetBucketPolicy"
                  # Return the tag set associated with an Amazon S3 bucket.
                  - "s3:GetBucketTagging"
                  # Return the versioning state of an Amazon S3 bucket.
                  - "s3:GetBucketVersioning"
                  # Return the website configuration for an Amazon S3 bucket.
                  - "s3:GetBucketWebsite"
                  # Get a metrics configuration from an Amazon S3 bucket.
                  - "s3:GetMetricsConfiguration"
                  # Return configuration information about the specified multi region access point.
                  - "s3:GetMultiRegion*"
                  # List access points.
                  - "s3:ListAccessPoints*"
                  # List all buckets owned by the authenticated sender of the request.
                  - "s3:ListAllMyBuckets"
                  # List metadata about all the versions of objects in an Amazon S3 bucket.
                  - "s3:ListBucketVersions"

                  #
                  ## SES (Simple Email Service) V1
                  # https://docs.aws.amazon.com/ses/latest/APIReference/API_Operations.html

                  # Return the email sending status of your account.
                  - "ses:GetAccountSendingEnabled"
                  # Returns the user's sending statistics.
                  - "ses:GetSendStatistics"
                  # Return the template object, which includes the subject line, HTML par, and text part for the template you specify.
                  - "ses:GetTemplate"
                  # List the email templates present in your account.
                  - "ses:ListTemplates"
                  # List all of the email addresses that have been verified in your account.
                  - "ses:ListVerifiedEmailAddresses"

                  #
                  ## SES (Simple Email Service) V2
                  # https://docs.aws.amazon.com/ses/latest/APIReference-V2/API_Operations.html

                  # Get information about the email-sending status and capabilities for your account.
                  - "ses:GetAccount"
                  # Retrieve the results of a predictive inbox placement test.
                  - "ses:GetDeliverabilityTestReport"
                  # Retrieve all the deliverability data for a specific campaign.
                  - "ses:GetDomainDeliverabilityCampaign"
                  # Retrieve inbox placement and engagement rates for the domains that you use to send email.
                  - "ses:GetDomainStatisticsReport"
                  # Return the template object, which includes the subject line, HTML part, and text part for the template you specify.
                  - "ses:GetEmailTemplate"
                  # Retrieve the list of the predictive inbox placement tests that you've performed, regardless of their statuses, for your account.
                  - "ses:ListDeliverabilityTestReports"
                  # List deliverability data for campaigns that used a specific domain to send email during a specified time range.
                  - "ses:ListDomainDeliverabilityCampaigns"
                  # List the email identities for your account.
                  - "ses:ListEmailIdentities"
                  # List all of the email templates for your account.
                  - "ses:ListEmailTemplates"
                  # Retrieve a list of the tags (keys and values) that are associated with a specific resource for your account.
                  - "ses:ListTagsForResource"

                  #
                  ## SNS (Simple Notification System)
                  # https://docs.aws.amazon.com/sns/latest/api/API_Operations.html

                  # Return a list of the requester's subscriptions.
                  - "sns:ListSubscriptions*"
                  # List all tags added to the specified Amazon SNS topic.
                  - "sns:ListTagsForResource"
                  # Return a list of the requester's topics.
                  - "sns:ListTopics"

                  #
                  ## SQS (Simple Queue Service)
                  # https://docs.aws.amazon.com/AWSSimpleQueueService/latest/APIReference/API_Operations.html

                  # Get attributes for the specified queue.
                  - "sqs:GetQueueAttributes"
                  # Return the URL of an existing queue.
                  - "sqs:GetQueueUrl"
                  # List of your queues that have the RedrivePolicy queue attribute configured with a dead letter queue
                  - "sqs:ListDeadLetterSourceQueues"
                  # List tags added to an SQS queue
                  - "sqs:ListQueueTags"
                  # Return a list of your queues
                  - "sqs:ListQueues"

                  #
                  ## Step Functions
                  # https://docs.aws.amazon.com/step-functions/latest/apireference/API_Operations.html

                  # Describe an activity
                  - "states:DescribeActivity"
                  # Describe an execution
                  - "states:DescribeExecution"
                  # Describe a state machine
                  - "states:DescribeStateMachine*"
                  # Retrieve a task (with the specified activity ARN) which has been scheduled for execution by a running state machine
                  - "states:GetActivityTask"
                  # Return the history of the specified execution as a list of events
                  - "states:GetExecutionHistory"
                  # List the existing activities
                  - "states:ListActivities"
                  # List the executions of a state machine
                  - "states:ListExecutions"
                  # Lists the existing state machines
                  - "states:ListStateMachines"
                  # List tags for an AWS Step Functions resource
                  - "states:ListTagsForResource"

                  #
                  ## X-Ray
                  # https://docs.aws.amazon.com/xray/latest/api/API_Operations.html

                  # Retrieve a list of traces specified by ID. Each trace is a collection of segment documents that originates from a single request. Use GetTraceSummaries to get a list of trace IDs.
                  - "xray:BatchGetTraces"
                  # Retrieve group resource details.
                  - "xray:GetGroup*"
                  # Retrieve the details of a specific insight.
                  - "xray:GetInsight*"
                  # Retrieve all sampling rules.
                  - "xray:GetSampling*"
                  # Retrieve a document that describes services that process incoming requests, and downstream services that they call as a result.
                  - "xray:GetServiceGraph"
                  # Retrieve an aggregation of service statistics defined by a specific time range bucketed into time intervals.
                  - "xray:GetTimeSeriesServiceStatistics"
                  # Retrieve a service graph for one or more specific trace IDs.
                  - "xray:GetTraceGraph"
                  # Retrieve IDs and metadata for traces available for a specified time frame using an optional filter. To get the full traces, pass the trace IDs to BatchGetTraces.
                  - "xray:GetTraceSummaries"
                  # List tags for an X-Ray resource.
                  - "xray:ListTagsForResource"

                  #
                  ##
                  ###
                  #### WRITE PERMISSIONS
                  ###
                  ##
                  #

                  #
                  ## API Gateway
                  # https://docs.aws.amazon.com/apigateway/latest/api/API_Operations.html

                  # Serverless Inc. Comments: This enables us to automatically configure and continuously verify configuration exists for enabling logging from API Gateway and ingesting those logs.
                  # Changes information about a Stage resource.
                  - "apigateway:UpdateStage"

                  #
                  ## App Runner
                  # https://docs.aws.amazon.com/apprunner/latest/api/API_Operations.html

                  # Add tags to, or update tag values of, an AWS App Runner resource.
                  - "apprunner:TagResource"
                  # Remove tags from an AWS App Runner resource.
                  - "apprunner:UntagResource"

                  #
                  ## AppSync
                  # https://docs.aws.amazon.com/apprunner/latest/api/API_Operations.html

                  # Tag a resource.
                  - "appsync:TagResource"
                  # Untag a resource.
                  - "appsync:UntagResource"

                  #
                  ## Cloudfront
                  # https://docs.aws.amazon.com/cloudfront/latest/APIReference/API_Operations.html

                  # Add tags to a CloudFront resource.
                  - "cloudfront:TagResource"
                  # Remove tags from a CloudFront resource.
                  - "cloudfront:UntagResource"

                  #
                  ## CloudTrail
                  # https://docs.aws.amazon.com/awscloudtrail/latest/APIReference/API_Operations.html

                  # Add one or more tags to a trail, up to a limit of 10.
                  - "cloudtrail:AddTags"
                  # Remove tags from a trail.
                  - "cloudtrail:RemoveTags"

                  #
                  ## Cloudwatch
                  # https://docs.aws.amazon.com/AmazonCloudWatch/latest/APIReference/API_Operations.html

                  # Add tags to an Amazon CloudWatch resource.
                  - "cloudwatch:TagResource"
                  # Remove a tag from an Amazon CloudWatch resource.
                  - "cloudwatch:UntagResource"

                  ##
                  ## Cloudwatch Logs
                  # https://docs.aws.amazon.com/AmazonCloudWatchLogs/latest/APIReference/API_Operations.html
                  # Serverless Inc. Comments: These enables us to automatically configure and continuously verify configuration exists Subscription filters for Cloudwatch.
                  # Creates or updates a destination. This operation is used only to create destinations for cross-account subscriptions.
                  # A destination encapsulates a physical resource (such as an Amazon Kinesis stream) and enables you to subscribe to a real-time stream of log events for a different account, ingested using PutLogEvents.
                  # Through an access policy, a destination controls what is written to it. By default, PutDestination does not set any access policy with the destination, which means a cross-account user cannot call PutSubscriptionFilter against this destination. To enable this, the destination owner must call PutDestinationPolicy after PutDestination.

                  # To perform a PutDestination operation, you must also have the iam:PassRole permission.
                  - "logs:PutDestination"
                  # Creates or updates an access policy associated with an existing destination. An access policy is an IAM policy document that is used to authorize claims to register a subscription filter against a given destination.
                  - "logs:PutDestinationPolicy"
                  # Create or update a subscription filter and associates it with the specified log group.
                  - "logs:PutSubscriptionFilter"
                  # Delete a subscription filter associated with the specified log group.
                  - "logs:DeleteSubscriptionFilter"
                  # Add or update the specified tags for the specified log group.
                  - "logs:TagLogGroup"
                  # Remove the specified tags from the specified log group.
                  - "logs:UntagLogGroup"

                  #
                  ## CodeDeploy
                  # https://docs.aws.amazon.com/codedeploy/latest/APIReference/API_Operations.html

                  # Associate the list of tags in the input Tags parameter with the resource identified by the ResourceArn input parameter.
                  - "codedeploy:TagResource"
                  # Disassociate a resource from a list of tags. The resource is identified by the ResourceArn input parameter. The tags are identfied by the list of keys in the TagKeys input parameter.
                  - "codedeploy:UntagResource"

                  #
                  ## Cost Explorer
                  # https://docs.aws.amazon.com/aws-cost-management/latest/APIReference/API_Operations_AWS_Cost_Explorer_Service.html

                  # Tag a Cost Explorer resource.
                  - "ce:TagResource"
                  # Remove tags from a Cost Explorer resource.
                  - "ce:UntagResource"

                  #
                  ## DynamoDB
                  # https://docs.aws.amazon.com/amazondynamodb/latest/APIReference/API_Operations_Amazon_DynamoDB.html

                  # Associate a set of tags with an Amazon DynamoDB resource.
                  - "dynamodb:TagResource"
                  # Remove the association of tags from an Amazon DynamoDB resource.
                  - "dynamodb:UntagResource"

                  #
                  ## ECS
                  # https://docs.aws.amazon.com/AmazonECS/latest/APIReference/API_Operations.html

                  # Tag the specified resource.
                  - "ecs:TagResource"
                  # Untag the specified resource.
                  - "ecs:UntagResource"

                  #
                  ## ElastiCache
                  # https://docs.aws.amazon.com/AmazonElastiCache/latest/APIReference/API_Operations.html

                  # Add tags to an ElastiCache resource.
                  - "elasticache:AddTagsToResource"
                  # Remove tags from a ElastiCache resource.
                  - "elasticache:RemoveTagsFromResource"

                  #
                  ## ELB (Elastic Load Balancing) V1
                  # https://docs.aws.amazon.com/elasticloadbalancing/2012-06-01/APIReference/API_Operations.html

                  # Adds the specified tags to the specified load balancer. Each load balancer can have a maximum of 10 tags.
                  - "elasticloadbalancing:AddTags"
                  # Removes one or more tags from the specified load balancer.
                  - "elasticloadbalancing:RemoveTags"

                  #
                  ## ELB (Elastic Load Balancing) V2
                  # https://docs.aws.amazon.com/elasticloadbalancing/latest/APIReference/API_Operations.html

                  # Adds the specified tags to the specified load balancer. Each load balancer can have a maximum of 10 tags.
                  - "elasticloadbalancing:AddTags"
                  # Removes one or more tags from the specified load balancer.
                  - "elasticloadbalancing:RemoveTags"

                  #
                  ## EMR (Elastic Map Reduce)
                  # https://docs.aws.amazon.com/emr/latest/APIReference/API_Operations.html

                  # Add tags to an Amazon EMR resource.
                  - "elasticmapreduce:AddTags"
                  # Remove tags from an Amazon EMR resource.
                  - "elasticmapreduce:RemoveTags"

                  #
                  ## ES (ElasticSearch)
                  # https://docs.aws.amazon.com/opensearch-service/latest/developerguide/configuration-api.html

                  # Attach resource tags to an OpenSearch Service domain.
                  - "es:AddTags"
                  # Remove resource tags from an OpenSearch Service domain.
                  - "es:RemoveTags"

                  #
                  ## Kinesis
                  # https://docs.aws.amazon.com/kinesis/latest/APIReference/API_Operations.html

                  # Add or update tags for the specified Amazon Kinesis stream. Each stream can have up to 10 tags.
                  - "kinesis:AddTagsToStream"
                  # Remove tags from the specified Kinesis data stream. Removed tags are deleted and cannot be recovered after this operation successfully completes.
                  - "kinesis:RemoveTagsFromStream"

                  #
                  ## Lambda
                  # https://docs.aws.amazon.com/lambda/latest/dg/API_Operations.html

                  # Modify the version-specific settings of an AWS Lambda function
                  - "lambda:UpdateFunctionConfiguration"
                  # Invoke a function asynchronously
                  - "lambda:InvokeAsync"
                  # Invoke an AWS Lambda function
                  - "lambda:InvokeFunction"
                  # Add tags to an AWS Lambda function
                  - "lambda:TagResource"
                  # Remove tags from an AWS Lambda function
                  - "lambda:UntagResource"

                  #
                  ## Organizations
                  # https://docs.aws.amazon.com/organizations/latest/APIReference/API_Operations.html

                  # Add one or more tags to the specified resource.
                  - "organizations:TagResource"
                  # Remove one or more tags from the specified resource.
                  - "organizations:UntagResource"

                  #
                  ## Resource Group Tagging
                  # https://docs.aws.amazon.com/resourcegroupstagging/latest/APIReference/API_Operations.html

                  # Apply one or more tags to the specified resources.
                  - "tag:TagResources"
                  # Remove the specified tags from the specified resources.
                  - "tag:TagResources"

                  #
                  ## RDS (Relational Database Service)
                  # https://docs.aws.amazon.com/AmazonRDS/latest/APIReference/API_Operations.html

                  # Add metadata tags to an Amazon RDS resource.
                  - "rds:AddTagsToResource"
                  # Remove metadata tags from an Amazon RDS resource.
                  - "rds:RemoveTagsFromResource"

                  #
                  ## S3
                  # https://docs.aws.amazon.com/AmazonS3/latest/API/API_Operations_Amazon_Simple_Storage_Service.html

                  # Grants permission to receive notifications when certain events happen in an Amazon S3 bucket.
                  - "s3:PutBucketNotification"
                  # Add a set of tags to an existing Amazon S3 bucket.
                  - "s3:PutBucketTagging"

                  #
                  ## SES (Simple Email Service) V2
                  # https://docs.aws.amazon.com/ses/latest/APIReference-V2/API_Operations.html

                  # Add one or more tags (keys and values) to a specified resource.
                  - "ses:TagResource"
                  # Remove one or more tags (keys and values) from a specified resource.
                  - "ses:UntagResource"

                  #
                  ## SQS (Simple Queue Service)
                  # https://docs.aws.amazon.com/AWSSimpleQueueService/latest/APIReference/API_Operations.html

                  - "sqs:TagQueue"
                  - "sqs:UntagQueue"

                  #
                  ## Step Functions
                  # https://docs.aws.amazon.com/step-functions/latest/apireference/API_Operations.html

                  - "states:TagResource"
                  - "states:UntagResource"

                  #
                  ## X-Ray
                  # https://docs.aws.amazon.com/xray/latest/api/API_Operations.html

                  # Add tags to an X-Ray resource.
                  - "xray:TagResource"
                  # Remove tags from an X-Ray resource.
                  - "xray:UntagResource"
                Resource: "*"

Parameters:
  ExternalId:
    Description: "[!Do not change!] External ID for securing the role"
    Type: String
